import{j as o}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.BMc0qTdX.js";import{x as P}from"./icon.gG8nFjUr.js";import"./_commonjsHelpers.CqkleIqs.js";import"./cn.C3L7WLNA.js";function $(t){if(!t||t==="/")return"/";const e=t.trim();return(e.startsWith("/")?e:`/${e}`).replace(/\/+$/,"")||"/"}function N(t){return t==="/"||t.length===0?"/index.html.md":`${t.replace(/\/+$/,"")}/index.html.md`}function x(t,e){const d=t==="/"?"":t.replace(/\/+$/,""),s=e.startsWith("/")?e:`/${e}`;return`${d}${s}`}async function y(t){if(navigator.clipboard?.writeText){await navigator.clipboard.writeText(t);return}const e=document.createElement("textarea");e.value=t,e.setAttribute("readonly","true"),e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}async function g(t){const e=await fetch(t,{cache:"no-store"});if(!e.ok)throw new Error(`Unable to load markdown from ${t}`);return e.text()}function L({currentPath:t,baseUrl:e,siteName:d,llmsIndex:s}){const[f,l]=i.useState(!1),[w,m]=i.useState(!1),[u,r]=i.useState("idle"),[b,n]=i.useState("Paste into your AI tool or notes."),c=i.useMemo(()=>$(t),[t]),h=s.pageMarkdownByPath[c]??N(c),k=w||f,p=u==="loading-page"||u==="loading-site";async function M(){try{r("loading-page"),n("Preparing current page markdown...");const a=await g(x(e,h));await y(a),r("success-page"),n(`Copied page markdown (${s.pageTitleByPath[c]??c}).`)}catch{r("error"),n("Failed to copy page markdown.")}}async function C(){try{r("loading-site"),n("Preparing full-site markdown...");const a=s.siteMarkdownPath||"/llms-full.txt",j=await g(x(e,a));await y(j),r("success-site"),n(`Copied full-site markdown for ${d}.`)}catch{r("error"),n("Failed to copy site markdown.")}}function v(a){a.currentTarget.contains(a.relatedTarget)||l(!1)}return o.jsxs("div",{className:"relative pointer-events-auto",onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),onFocusCapture:()=>l(!0),onBlurCapture:v,children:[o.jsx("button",{type:"button",onClick:()=>l(a=>!a),className:"h-12 w-12 rounded-full border border-gray-200 bg-white text-gray-700 shadow-lg hover:text-gray-900","aria-label":"Open markdown copy tools",children:o.jsxs("span",{className:"inline-flex items-center justify-center gap-1 text-xs font-semibold",children:[o.jsx(P,{icon:"bot",iconLibrary:"lucide",size:14}),"MD"]})}),k&&o.jsxs("div",{className:"absolute bottom-14 right-0 w-72 rounded-2xl border border-gray-200 bg-white p-3 shadow-2xl",children:[o.jsx("p",{className:"m-0 text-sm font-semibold text-gray-900",children:"LLM Markdown"}),o.jsx("p",{className:"mt-1 mb-3 text-xs text-gray-500",children:b}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx("button",{type:"button",className:"w-full rounded-xl border border-gray-200 px-3 py-2 text-left text-sm font-medium text-gray-800 hover:bg-gray-50 disabled:opacity-60",onClick:()=>void M(),disabled:p,children:"Copy Page as Markdown"}),o.jsx("button",{type:"button",className:"w-full rounded-xl border border-gray-200 px-3 py-2 text-left text-sm font-medium text-gray-800 hover:bg-gray-50 disabled:opacity-60",onClick:()=>void C(),disabled:p,children:"Copy Site as Markdown"})]})]})]})}export{L as default};
